$connection = New-Object System.Data.SqlClient.SqlConnection
$connection.ConnectionString = "Server=localhost;Database=master;Integrated Security=True"
$connection.Open()

$command = $connection.CreateCommand()
$command.CommandText = "SELECT name FROM sys.databases"

$reader = $command.ExecuteReader()
while ($reader.Read()) {
    $reader["name"]
}

$connection.Close()